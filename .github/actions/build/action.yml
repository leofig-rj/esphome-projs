name: 'Build configs'
description: ''
inputs:
  device:
    description: 'Device to compile'
    required: true
runs:
  using: "composite"
  steps:
    - name: Install Dependencies
      shell: bash
      run: |
        apt update
        apt install -y jq

    - name: Get info
      id: info
      shell: bash
      run: |
        esphome=$(esphome config ${{ inputs.device }}.yaml | yq ".esphome")
        name=$(echo $esphome | yq -r ".project.name")
        version=$(echo $esphome | yq -r ".project.version")
        devicename=$(echo $esphome | yq -r ".name")
        esphome_version=$(esphome version)
        esphome_version=$(echo $esphome_version | cut -d " " -f 2)

        echo "name=$name" >> $GITHUB_OUTPUT
        echo "version=$version" >> $GITHUB_OUTPUT
        echo "devicename=$devicename" >> $GITHUB_OUTPUT
        echo "esphome_version=$esphome_version" >> $GITHUB_OUTPUT

